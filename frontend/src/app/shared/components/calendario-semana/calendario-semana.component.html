<div *ngIf="!isLoading; else loadingTemplate">
  <div class="calendar-week">
    <div class="calendar-header">
      <button class="nav-button" (click)="prevWeek()">&#8249;</button>
      <h3>{{ weekRange }}</h3>
      <button class="nav-button" (click)="nextWeek()">&#8250;</button>
    </div>
    <table class="week-table">
      <thead>
        <tr>
          <th>Hora</th>
          <th *ngFor="let day of weekDays">
            {{ day | date: 'EEE dd/MM' }}
          </th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let block of scheduleGrouped">
          <tr>
            <td class="time-cell" rowspan="2">{{ block.hourLabel }}</td>
            <td *ngFor="let cell of block.slot1.cells"
                (click)="!cell.disabled && selectSlot(cell.day, block.slot1.time)"
                [ngClass]="{
                  'available': cell.available && !cell.disabled,
                  'not-available': !cell.available && !cell.disabled,
                  'disabled': cell.disabled
                }">
              <!-- Sin texto; se indica solo por el color -->
            </td>
          </tr>
          <!-- Se agrega la clase "hour-group-end" para marcar el final del bloque -->
          <tr *ngIf="block.slot2" class="hour-group-end">
            <td *ngFor="let cell of block.slot2.cells"
                (click)="!cell.disabled && selectSlot(cell.day, block.slot2.time)"
                [ngClass]="{
                  'available': cell.available && !cell.disabled,
                  'not-available': !cell.available && !cell.disabled,
                  'disabled': cell.disabled
                }">
              <!-- Sin texto; se indica solo por el color -->
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading">
    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
  </div>
</ng-template>
